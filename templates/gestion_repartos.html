{% extends "base.html" %}  <!-- Extiende la plantilla base para mantener la integridad del diseño -->

{% block content %}  <!-- Bloque para el contenido específico de esta página -->
<div class="container mt-4">
    <!-- Título principal de la sección de Gestión de Repartos -->
    <h1 class="title text-center mb-4">Gestión de Repartos</h1>

    <!-- Formulario para crear o actualizar un reparto -->
    <form method="POST" action="{{ url_for('gestion_repartos') }}" class="mb-5">
        <div class="form-group">
            <label for="client_name">Nombre del Cliente</label>
            <input type="text" class="form-control" id="client_name" name="client_name" required>
        </div>
        <div class="form-group">
            <label for="delivery_date">Fecha de Entrega</label>
            <input type="date" class="form-control" id="delivery_date" name="delivery_date" required>
        </div>
        <div class="form-group">
            <label for="items_delivered">Ítems Entregados</label>
            <input type="text" class="form-control" id="items_delivered" name="items_delivered" required>
        </div>
        <div class="form-group">
            <label for="notes">Notas</label>
            <textarea class="form-control" id="notes" name="notes" rows="3"></textarea>
        </div>
        <!-- Botón para guardar el reparto -->
        <button type="submit" class="btn btn-primary">Guardar Reparto</button>
    </form>

    <!-- Sección de repartos existentes -->
    <h2 class="mb-3">Repartos Existentes</h2>
    <table class="table table-dark table-hover">
        <thead>
            <tr>
                <th>Nombre del Cliente</th>
                <th>Fecha de Entrega</th>
                <th>Ítems Entregados</th>
                <th>Notas</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for delivery in deliveries %}
            <tr>
                <td>{{ delivery.client_name }}</td>
                <td>{{ delivery.delivery_date.strftime('%Y-%m-%d') }}</td>
                <td>{{ delivery.items_delivered }}</td>
                <td>{{ delivery.notes }}</td>
                <td>
                    <!-- Formulario para editar un reparto existente -->
                    <form method="POST" action="{{ url_for('gestion_repartos') }}" class="d-inline">
                        <input type="hidden" name="delivery_id" value="{{ delivery.id }}">
                        <button type="submit" class="btn btn-warning btn-sm">Editar</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
